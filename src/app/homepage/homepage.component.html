<br><br>

<div class="container-fluid py-4 a">
  <div class="row">
    <!-- Columna Izquierda: Feed -->
    <div class="col-md-7">
      <div class="feed mb-4">
        <h2 class="mb-3 text-center">Feed</h2>
        @for(item of displayedFeedItems; track item.id) {
          <div class="card mb-3 shadow-sm">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-center">
                <h5 class="card-title mb-0">{{ item.title }}</h5>
                <small class="text-muted">{{ item.date }}</small>
              </div>
              <p class="card-text mt-2">{{ item.content }}</p>
              @if(item.type === 'event') {
                <div class="text-end">
                  <button class="btn btn-primary" (click)="joinEvent(item.id, item.communityID)">Join</button>
                </div>
              }
            </div>
          </div>
        }
        <div class="text-center">
          <button class="btn btn-outline-primary" (click)="loadMoreFeed()">Show more</button>
        </div>
      </div>
    </div>

    <!-- Columna Derecha: Comunidades y Calendario -->
    <div class="col-md-4">
      <!-- Una sola tarjeta para comunidades -->
      <div class="card mb-4 shadow-card">
        <div class="card-body">
          <h4 class="mb-3 text-center">Recommended communities</h4>
          @for(community of communities; track community.id) {
            <div class="community-item mb-2">
              <strong>{{ community.name }}</strong>
              <p class="mb-1">{{ community.description }}</p>
              <div class="text-end">
                <a class="btn btn-outline-secondary btn-sm" (click)="joinCommunity(community.id); $event.preventDefault()">Join</a>
              </div>
              <hr>
            </div>
          }
        </div>
      </div>

      <!-- Calendario en la parte inferior derecha -->
      <!-- Calendario en la parte inferior derecha -->
      <div class="calendar">
        <h3 class="mb-3">Calendar</h3>
        <div class="card">
          <div class="card-body p-0">
            <table class="table table-bordered mb-0 text-center">
              <thead class="table-light">
                <tr>
                  <th *ngFor="let day of dayNames; trackBy: trackByDayName">
                    {{ day }}
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let week of calendarWeeks; let weekIndex = index; trackBy: trackByWeek">
                  <td *ngFor="let day of week; let dayIndex = index; trackBy: trackByDay">
                    <ng-container *ngIf="day; else emptyCell">
                      <div class="day-container">
                        <span class="day-content" [ngClass]="{'today': day === todayDay}">
                          {{ day }}
                        </span>
                        <div *ngIf="calendarEvents[day]" class="event-dots">
                          <span *ngFor="let event of calendarEvents[day]; let eventIndex = index; trackBy: trackByEvent" 
                                class="event-dot" 
                                [title]="event">
                          </span>
                        </div>
                      </div>
                    </ng-container>
                    <ng-template #emptyCell>
                      <!-- Celda vacÃ­a -->
                    </ng-template>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
