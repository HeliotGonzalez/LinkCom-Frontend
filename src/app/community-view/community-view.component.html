<main class="main d-flex flex-column flex-grow-1">
    <div class="d-flex flex-column w-100 align-items-center">
        <div id="community-image-container"
             class="d-flex align-items-center justify-content-center overflow-hidden w-100 bg-white">
            <img [src]="this.community?.imagePath">
        </div>
        <div id="community-name-container" class="d-flex align-items-center justify-content-center w-100">
            <h1 class="fw-bold"> {{ this.community?.name }}'s Community </h1>
        </div>
        <div class="d-flex flex-column bg-white w-50">
            <div id="announces-section-container" class="d-flex flex-column w-100">
                <section id="announces-section" class="d-flex flex-column align-items-center h-100 overflow-auto">
                    <div class="d-flex gap-3">
                        <button class="button mb-5 mt-5" (click)="showAnnouncements()">Go to the community news!
                        </button>
                        <button class="button mb-5 mt-5" (click)="showAnnouncementForm()">New Announcement</button>
                    </div>
                    @if (announcements.length === 0) {
                        <p>There is no news yet</p>
                    } @else {
                        @for (newAnnounce of announcements; track newAnnounce) {
                            <app-announcement-card
                                    [announce]="newAnnounce"
                                    [imgPath]="this.community!.imagePath!"
                            ></app-announcement-card>
                        }
                    }
                </section>
            </div>
            <div id="community-body" class="d-flex flex-column">
                <div class="d-flex flex-column align-items-center justify-content-center">
                    <div class="d-flex gap-3 p-3">
                        <button class="button" (click)="showEventForm()">Create Event</button>
                        @if (!isCreator()) {
                            @if (isUserJoined) {
                                <button class="leave-button" (click)="leaveCommunity()">Leave Community
                                </button>
                            } @else {
                                <button class="button" (click)="joinCommunity()">Join Community</button>
                            }
                        } @else {
                            <button class="button" (click)="showModeratorsManagement()">Manage moderators</button>
                            <button class="button" (click)="showRequestsPanel()">Requests Panel</button>
                            <button class="leave-button" (click)="removeCommunity()">Remove community</button>
                        }
                    </div>
                </div>
                <section id="events-section" class="d-flex flex-column w-100">
                    @for (event of events; track $index) {
                        <app-event-view [event]="event" [isDisabled]="isUserInEvent(event)"></app-event-view>
                    }
                </section>
            </div>
        </div>
    </div>
    <app-community-requests-panel (eventEmitter)="closeRequestPanel()" [isVisible]="requestPanelVisible"></app-community-requests-panel>
</main>